<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="/static/css/prism.css"><meta charset="UTF-8"><link rel="icon" href="/favicon.ico" sizes="32x32" type="image/x-icon"><meta name="viewport" content="width=device-width, min-width=800"><link rel="stylesheet" href="/static/css/styles.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&amp;family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet"><meta name="description" content="Description of a rare bug in youtube website, and a possible cause of that bug"><meta name="keywords" content="web,python,essay"><title>Reading The Tea Leaves</title></head><body>
<img class="bg" id="main_bg" src="/static/img/bg.jpg" alt="">










<div id="body_wrapper" class="first_body_wrapper"><header><nav><a href="/">
              HOME
          </a><a href="/projects.html">
              PROJECTS
          </a><a href="/tags.html">
              TAGS
          </a></nav><h1 id="main_title">Reading The Tea Leaves</h1><ul class="tags_list"><li><a class="tag_element" href="/tags/web.html">web</a></li><li><a class="tag_element" href="/tags/python.html">python</a></li><li><a class="tag_element" href="/tags/essay.html">essay</a></li></ul><div style="width: calc(100% - 2em); height: 5px; margin: 1em auto 0; border: solid black; border-width: 1px 0;"></div></header><article>
    <p>
        I used to encounter a bug in youtube website a couple of years ago. In this article, I'm going to talk about a
        possible cause of that bug.
    </p>
    <p>
        I believe this bug slipped past the QA because it only manifests itself when you're on a flaky 2G connection
        (&lt;50kbps), and apparently all the web developers/testers use a 1GB connection with 5ms ping, that never disconnects.
    </p>
    <p>
        However, I have to say that youtube webapp is one of the highest quality websites I've seen. It handles network
        disconnects and reconnects flawlessly, and keyboard controls are better than any other streaming platform.
    </p>
    <h2>The bug</h2>
    <p>
        The bug was that if you were watching videos at 144p (which is the only option at that bandwidth), and the network
        disconnects, after the reconnection, the quality setting on the video changes to the highest quality. The cause
        of this bug is obvious if you know that the youtube backend is written in python.
    </p>
    <h2>The cause</h2>
    <p>
        In python, you can index an array with a negative number to index it in reverse.
    </p>
    <prog class=" language-python" role="figure"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">720</span><span class="token punctuation">,</span> <span class="token number">1080</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token number">144</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token number">1080</span></prog>
    <p>
        I think what used to happen was that I'd select index <progi role="figure">0</progi> as my preferred quality setting. The
        backend would notice that my bandwidth isn't good enough, and decremented my quality setting to <progi role="figure">-1</progi>. Which
        just caused the video to lag even more.
    </p>
    <p>
        I think this bug is still there. I remember seeing this bug a couple months ago (I'm not sure). You see, bandwidth
        isn't the only reason to play videos in lowest quality. Playing HD video takes a non trivial amount of cpu, so I
        switch the quality on music videos to lowest whenever I'm compiling something.
    </p>
</article><footer>
    <div class="links">
        <div class="social">
            <div class="footer-title">Share this page:</div>
            <a rel="noopener" title="twitter" class="svg-icon twitter" target="_blank" href="https://twitter.com/share?text=Reading The Tea Leaves&amp;url=https://fctorial.github.io/posts/youtube_python_bug.html"></a>
            <a rel="noopener" title="facebook" class="svg-icon facebook" target="_blank" href="https://www.facebook.com/sharer.php?u=https://fctorial.github.io/posts/youtube_python_bug.html"></a>
            <a rel="noopener" title="reddit" class="svg-icon reddit" target="_blank" href="https://www.reddit.com/submit?title=Reading The Tea Leaves&amp;url=https://fctorial.github.io/posts/youtube_python_bug.html"></a>
        </div>
        <div class="social">
            <div class="footer-title">Contacts:</div>
            <a rel="noopener" title="github" href="https://github.com/fctorial" class="svg-icon github"></a>
            <a rel="noopener" title="twitter" href="https://twitter.com/fctorial1" class="svg-icon twitter"></a>
            <a rel="noopener" title="email" href="mailto:fctorial@gmail.com" class="svg-icon email"></a>
        </div>
    </div>

<a rel="noopener" class="discussion" target="_blank" href="https://www.reddit.com/r/fctorial/comments/me5fg2/reading_the_tea_leaves/">Join the discussion here</a></footer></div></body></html>